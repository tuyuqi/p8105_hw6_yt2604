---
title: "HW6_P1"
author: "Yuqi Tu"
date: "November 14, 2017"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill

---


```{r library, message=FALSE, warning=FALSE}
library(tidyverse)
library(tidytext)
library(rvest)
library(httr)
library(haven)
library(janitor)
library(rnoaa)
library(stringr)
library(forcats)
library(viridis)
library(plotly)
library(flexdashboard)
```




```{r read and load data, message= FALSE, warning= FALSE}
instacart = read_csv("./data_hw6/instacart_train_data.csv.zip") %>%
    clean_names()
```



```{r department pie chart analysis}
most_department_items_ordered= summarize(group_by(instacart, department),n=n())
 
least_department_items_ordered= summarize(group_by(instacart, department),n=n()) %>% 
  filter(n == min(n)) %>% 
  select(department)
as.character(least_department_items_ordered)
```


```{r data analysis order hour for items from the household department}
household = 
  filter(instacart,department == "household") %>%
  select(department, order_hour_of_day) %>%
  arrange(order_hour_of_day)
```


```{r analysis}

```








Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r pie chart plot }

```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r histogram plot }
#  the hour of the day on which the order was placed for household department
fit <- density(household$order_hour_of_day)
household_plot =
  household %>%
  plot_ly(x = ~order_hour_of_day, type = "histogram", name = "Frequency") %>%
  add_trace(x = fit$x, y = fit$y, type= "scatter", mode = "lines", fill = "tozeroy", yaxis = "y2", name = "Density") %>%
  layout(yaxis2 = list(overlaying = "y", side = "right")) %>%
  layout(title = "The Hour of the Day on which the Order was placed for Household Department",
         xaxis = list(title = "Order hour of the day"), 
         yaxis = list(title = "Frequency"))
household_plot
## We can see from the plot that every day before 9am, there are not many order placed from the household department but it's increasing. At around 9am, orders placed reach the maximum from the household department and then decreases for the rest of the day. 
```


### Chart C

```{r scatter plot}

```



